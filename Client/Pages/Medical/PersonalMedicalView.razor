@page "/medical/personal-view/{PersonalId:guid}"
@using global::Shared.DTOs.Medical
@using global::Shared.Common
@using Radzen
@using Radzen.Blazor
@using Client.Services.Medical

<PageTitle>Vizualizare Personal Medical - ValyanMed</PageTitle>

<RadzenStack Orientation="Radzen.Orientation.Vertical" Gap="1rem" Class="p-4">
    
    <!-- Header cu navigare -->
    <RadzenStack Orientation="Radzen.Orientation.Horizontal" JustifyContent="JustifyContent.SpaceBetween" AlignItems="Radzen.AlignItems.Center" Class="mb-3">
        <RadzenStack Orientation="Radzen.Orientation.Horizontal" AlignItems="Radzen.AlignItems.Center" Gap="1rem">
            <RadzenButton Icon="arrow_back" 
                         ButtonStyle="ButtonStyle.Light" 
                         Variant="Radzen.Variant.Outlined"
                         Click="@GoBack" 
                         Title="Inapoi la lista" />
            <RadzenText TextStyle="TextStyle.H4" Class="mb-0">
                @if (_personalDetail != null)
                {
                    <text>Vizualizare Personal Medical - @_personalDetail.NumeComplet</text>
                }
                else
                {
                    <text>Vizualizare Personal Medical</text>
                }
            </RadzenText>
        </RadzenStack>
        
        @if (_personalDetail != null)
        {
            <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="1rem">
                <RadzenButton Text="Editeaza" 
                             Icon="edit" 
                             ButtonStyle="ButtonStyle.Info"
                             Click="@(() => EditPersonal(_personalDetail.PersonalID))" />
            </RadzenStack>
        }
    </RadzenStack>

    @if (_isLoading)
    {
        <!-- Loading State -->
        <RadzenCard Class="text-center p-5">
            <RadzenStack Orientation="Radzen.Orientation.Vertical" AlignItems="Radzen.AlignItems.Center" Gap="1rem">
                <RadzenProgressBarCircular ShowValue="false" Mode="ProgressBarMode.Indeterminate" Size="ProgressBarCircularSize.Large" />
                <RadzenText TextStyle="TextStyle.Body1">Se incarca datele...</RadzenText>
            </RadzenStack>
        </RadzenCard>
    }
    else if (_hasError)
    {
        <!-- Error State -->
        <RadzenCard Class="text-center p-5" Style="border-left: 4px solid #dc3545;">
            <RadzenStack Orientation="Radzen.Orientation.Vertical" AlignItems="Radzen.AlignItems.Center" Gap="1rem">
                <RadzenIcon Icon="error" Style="font-size: 3rem; color: #dc3545;" />
                <RadzenText TextStyle="TextStyle.H6">Nu s-au putut incarca datele</RadzenText>
                <RadzenText TextStyle="TextStyle.Body2">@_errorMessage</RadzenText>
                <RadzenButton Text="Incearca din nou" 
                             Icon="refresh" 
                             ButtonStyle="ButtonStyle.Primary"
                             Click="@LoadPersonalDetails" />
            </RadzenStack>
        </RadzenCard>
    }
    else if (_personalDetail == null)
    {
        <!-- Not Found State -->
        <RadzenCard Class="text-center p-5" Style="border-left: 4px solid #ffc107;">
            <RadzenStack Orientation="Radzen.Orientation.Vertical" AlignItems="Radzen.AlignItems.Center" Gap="1rem">
                <RadzenIcon Icon="person_off" Style="font-size: 3rem; color: #ffc107;" />
                <RadzenText TextStyle="TextStyle.H6">Personal medical nu a fost gasit</RadzenText>
                <RadzenText TextStyle="TextStyle.Body2">ID-ul personalului medical nu exista sau a fost sters.</RadzenText>
                <RadzenButton Text="Inapoi la lista" 
                             Icon="arrow_back" 
                             ButtonStyle="ButtonStyle.Primary"
                             Click="@GoBack" />
            </RadzenStack>
        </RadzenCard>
    }
    else
    {
        <!-- Main Content -->
        <RadzenCard>
            <!-- Informatii principale -->
            <RadzenRow Gap="2rem" Class="mb-4">
                <!-- Informatii Personale -->
                <RadzenColumn Size="12" SizeMD="6">
                    <RadzenCard Style="height: 100%; background-color: #f8f9fa;">
                        <RadzenText TextStyle="TextStyle.H6" Class="mb-3">
                            <RadzenIcon Icon="person" Class="me-2" Style="color: #28a745;" />
                            Informatii Personale
                        </RadzenText>
                        <RadzenStack Orientation="Radzen.Orientation.Vertical" Gap="1rem">
                            <RadzenRow>
                                <RadzenColumn Size="5"><strong>Nume complet:</strong></RadzenColumn>
                                <RadzenColumn Size="7">@_personalDetail.NumeComplet</RadzenColumn>
                            </RadzenRow>
                            <RadzenRow>
                                <RadzenColumn Size="5"><strong>Pozitie:</strong></RadzenColumn>
                                <RadzenColumn Size="7">
                                    <RadzenBadge Text="@_personalDetail.Pozitie" 
                                               BadgeStyle="BadgeStyle.Primary" 
                                               Variant="Radzen.Variant.Filled" />
                                </RadzenColumn>
                            </RadzenRow>
                            <RadzenRow>
                                <RadzenColumn Size="5"><strong>Specializare:</strong></RadzenColumn>
                                <RadzenColumn Size="7">@(_personalDetail.Specializare ?? "Nu este specificata")</RadzenColumn>
                            </RadzenRow>
                            <RadzenRow>
                                <RadzenColumn Size="5"><strong>Departament:</strong></RadzenColumn>
                                <RadzenColumn Size="7">@(_personalDetail.Departament ?? "Nu este specificat")</RadzenColumn>
                            </RadzenRow>
                            <RadzenRow>
                                <RadzenColumn Size="5"><strong>Nr. Licenta:</strong></RadzenColumn>
                                <RadzenColumn Size="7">
                                    <RadzenBadge Text="@(_personalDetail.NumarLicenta ?? "N/A")" 
                                               BadgeStyle="BadgeStyle.Secondary" 
                                               Variant="Radzen.Variant.Outlined" />
                                </RadzenColumn>
                            </RadzenRow>
                        </RadzenStack>
                    </RadzenCard>
                </RadzenColumn>

                <!-- Contact & Status -->
                <RadzenColumn Size="12" SizeMD="6">
                    <RadzenCard Style="height: 100%; background-color: #f8f9fa;">
                        <RadzenText TextStyle="TextStyle.H6" Class="mb-3">
                            <RadzenIcon Icon="contact_phone" Class="me-2" Style="color: #fd7e14;" />
                            Contact & Status
                        </RadzenText>
                        <RadzenStack Orientation="Radzen.Orientation.Vertical" Gap="1rem">
                            <RadzenRow>
                                <RadzenColumn Size="4"><strong>Telefon:</strong></RadzenColumn>
                                <RadzenColumn Size="8">
                                    @if (!string.IsNullOrEmpty(_personalDetail.Telefon))
                                    {
                                        <RadzenLink Text="@_personalDetail.Telefon" Path="@($"tel:{_personalDetail.Telefon}")" />
                                    }
                                    else
                                    {
                                        <span class="text-muted">Nu este specificat</span>
                                    }
                                </RadzenColumn>
                            </RadzenRow>
                            <RadzenRow>
                                <RadzenColumn Size="4"><strong>Email:</strong></RadzenColumn>
                                <RadzenColumn Size="8">
                                    @if (!string.IsNullOrEmpty(_personalDetail.Email))
                                    {
                                        <RadzenLink Text="@_personalDetail.Email" Path="@($"mailto:{_personalDetail.Email}")" />
                                    }
                                    else
                                    {
                                        <span class="text-muted">Nu este specificat</span>
                                    }
                                </RadzenColumn>
                            </RadzenRow>
                            <RadzenRow>
                                <RadzenColumn Size="4"><strong>Status:</strong></RadzenColumn>
                                <RadzenColumn Size="8">
                                    <RadzenBadge Text="@(_personalDetail.EsteActiv ? "ACTIV" : "INACTIV")" 
                                               BadgeStyle="@(_personalDetail.EsteActiv ? Radzen.BadgeStyle.Success : Radzen.BadgeStyle.Danger)" 
                                               Variant="Radzen.Variant.Filled"
                                               Style="font-weight: bold;" />
                                </RadzenColumn>
                            </RadzenRow>
                            <RadzenRow>
                                <RadzenColumn Size="4"><strong>Data crearii:</strong></RadzenColumn>
                                <RadzenColumn Size="8">
                                    <RadzenText TextStyle="TextStyle.Body2">
                                        @_personalDetail.DataCreare.ToString("dd MMM yyyy, HH:mm")
                                    </RadzenText>
                                </RadzenColumn>
                            </RadzenRow>
                        </RadzenStack>
                    </RadzenCard>
                </RadzenColumn>
            </RadzenRow>

            <!-- Statistici -->
            <RadzenRow>
                <RadzenColumn Size="12">
                    <RadzenCard Style="background-color: #f8f9fa; border-left: 4px solid #0d6efd;">
                        <RadzenText TextStyle="TextStyle.H6" Class="mb-3">
                            <RadzenIcon Icon="analytics" Class="me-2" Style="color: #0d6efd;" />
                            Statistici & Informatii Suplimentare
                        </RadzenText>
                        <RadzenRow Gap="2rem">
                            <RadzenColumn Size="12" SizeMD="4">
                                <RadzenStack Orientation="Radzen.Orientation.Vertical" AlignItems="Radzen.AlignItems.Center" Class="text-center">
                                    <RadzenIcon Icon="schedule" Style="font-size: 2rem; color: #0d6efd;" />
                                    <RadzenText TextStyle="TextStyle.H6">Vechime</RadzenText>
                                    <RadzenText TextStyle="TextStyle.Body1">
                                        @((DateTime.Now - _personalDetail.DataCreare).Days) zile
                                    </RadzenText>
                                </RadzenStack>
                            </RadzenColumn>
                            <RadzenColumn Size="12" SizeMD="4">
                                <RadzenStack Orientation="Radzen.Orientation.Vertical" AlignItems="Radzen.AlignItems.Center" Class="text-center">
                                    <RadzenIcon Icon="medical_services" Style="font-size: 2rem; color: #0d6efd;" />
                                    <RadzenText TextStyle="TextStyle.H6">Programari</RadzenText>
                                    <RadzenText TextStyle="TextStyle.Body1">@_personalDetail.TotalProgramari</RadzenText>
                                </RadzenStack>
                            </RadzenColumn>
                            <RadzenColumn Size="12" SizeMD="4">
                                <RadzenStack Orientation="Radzen.Orientation.Vertical" AlignItems="Radzen.AlignItems.Center" Class="text-center">
                                    <RadzenIcon Icon="people" Style="font-size: 2rem; color: #0d6efd;" />
                                    <RadzenText TextStyle="TextStyle.H6">Consultatii</RadzenText>
                                    <RadzenText TextStyle="TextStyle.Body1">@_personalDetail.TotalConsultatii</RadzenText>
                                </RadzenStack>
                            </RadzenColumn>
                        </RadzenRow>
                    </RadzenCard>
                </RadzenColumn>
            </RadzenRow>
        </RadzenCard>
    }
</RadzenStack>

<style>
    .personal-view-card {
        transition: box-shadow 0.2s ease;
    }
    
    .personal-view-card:hover {
        box-shadow: 0 4px 12px rgba(13, 110, 253, 0.15);
    }
</style>